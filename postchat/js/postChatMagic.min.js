var zK=p;!function(){for(var t=p,e=W();;)try{if(894922===parseInt(t(247))/1*(-parseInt(t(300))/2)+-parseInt(t(160))/3*(-parseInt(t(250))/4)+parseInt(t(279))/5*(-parseInt(t(346))/6)+-parseInt(t(345))/7+-parseInt(t(378))/8+parseInt(t(230))/9*(-parseInt(t(318))/10)+-parseInt(t(289))/11*(-parseInt(t(383))/12))break;e.push(e.shift())}catch(t){e.push(e.shift())}}();var d=function(){var t=!0;return function(e,a){var s=t?function(){if(a){var t=a[p(287)](e,arguments);return a=null,t}}:function(){};return t=!1,s}}(),z=d(this,(function(){var t=p;return z.toString()[t(158)](t(369))[t(170)]().constructor(z)[t(158)](t(369))}));function W(){var t=[".user-message","decode","editMessage","length","random","querySelector","请输入你的问题...","key","error",".postChatMagic-container","edit-actions","data","HTTP error! status: ","application/json","scrollTop","addEventListener","flex","clearMessages","getAttribute","delta","hostname",".postChatMagic-default-questions","10uNughN","https://ai.tianli0.top/static/img/PostChat.webp","createElement","hideChat","search-results-container","classList","postChatConfig","link","apply","copied","143juuSdr","postChat_containerVisible","copying","none","userIcon","postChatMagic-Tools","70b649f150276f289d1025508f60c5f58a",".postChatMagic-messages","forEach","https://ai.tianli0.top/api/KnowledgeChat?key=","code-block-wrapper","2BpazWg","addLoadingMessage","parentElement","getElementById","bindEvents","json","handleSubmit","postChatMagic-overlay","location","getReader","summary",".mode-switch-btn:last-child","_blank","message ai-message loading","input",".postChatMagic-overlay","shiftKey","clipboard","41190Adeqcf","magicUserInput","value","catch","head","keydown","src","Renderer","url","href","min","zhheo.com","</a>",' title="',"pre code","dispatchEvent","style","height","choices",".postChatMagic-Info","data:[DONE]","auto","renderdefaultChatQuestions","postChatMagic-Tips","markedLoaded","message ai-message search-results","start","8610315lPpXiQ","1118484gfWWFg","contains",".postChatMagic-input","slice",".message-content","message-content","defaultSearchQuestions","show","display","onerror","img","createOverlay","editing","Enter","assistant",".message.ai-message.loading","stopping","onload",'<img src="https://ai.tianli0.top/static/icon/arrow-up-bold.svg" alt="发送">',"children","user-message","https://ai.tianli0.top/static/plugin/marked.min.js","showElements","(((.+)+)+)+$","POST","message-tools","loadMarked","preventDefault","endsWith",".mode-switch-btn:first-child","textContent","innerWidth","11598408loFUtj","edit-save-btn","default-question-btn","postChatMagic-default-questions","24px","3066612ueqQwt","userTitle","createContainer","edit-btn","search-result",".postChatMagic-Tools","copy-failed","Escape","抱歉，服务器响应超时，请稍后重试","postChatMagic-container","sort","append","active","postChatMagic-submit","isStreaming","search","cursor","3VzYjJN","如果有问题欢迎问我哦！","loading","innerHTML","mode-switch-container","mode","chat_","search-result-title","focus","script","toString","role","className",".postChatMagic-submit","querySelectorAll","trim","postChatMagic","userDesc","copy-btn","clear-btn","init","复制失败:","split","open","可能会生成错误的信息，请注意核实。","scrollHeight","switchMode","defaultChatQuestions","发生错误：",".postChatMagic-Tips","没有获取到key，代码可能没有安装正确。","remove","Error:","info-icon",'<a href="',"findIndex","onclick","textarea","push","setSelectionRange","load","search-result-summary","insertBefore"," 条结果","message ","click","Content-Type","message","info-desc","alt",'<img src="https://ai.tianli0.top/static/icon/stop-2.svg" alt="停止">',"user","smooth","script[data-postChat_key]","then","resolve","editingMessage","body","message ai-message","now","pre","getKey","gpt-3.5-turbo","parse","addMessage","chat","disabled","div","target","title","1557VgcCUN","content","parentNode","button","heo_show","writeText","加载中...","stringify",'"的 ',".code-block-wrapper","pointer","read","Error parsing line:","replace","undefined","add","data-original-html","366029ZJdcqB","placeholder","https://ai.tianli0.top/?InviteID=","6816196ASNpBi","chatHistory","appendChild","code-copy-btn","status","试用PostChat",".clear-btn"];return(W=function(){return t})()}z();class PostChatMagic{constructor(){var t=p;this[t(264)]=this[t(221)](),this[t(342)]=!1,this[t(251)]=[],this[t(165)]="chat",this.isStreaming=!1,this.editingMessage=null}[zK(180)](){var t=zK;let e=document.getElementById(t(176));e?e.innerHTML="":((e=document[t(281)](t(227))).id=t(176),document.body.appendChild(e)),this[t(357)](),this[t(385)](),this.bindEvents()}[zK(357)](){var t=zK,e=document[t(281)]("div");e[t(172)]=t(307),document[t(303)](t(176))[t(252)](e)}[zK(385)](){var t,e,a=zK,s=document[a(303)](a(176)),n=((t=((t=document[a(281)]("div"))[a(172)]="postChatMagic-messages",s[a(252)](t),document[a(281)](a(227)))).className=a(294),document[a(281)]("button")),i=(n[a(172)]=a(179),n[a(376)]="清空",n[a(196)]=()=>this.clearMessages(),document[a(281)](a(227))),o=((e=((o=(i.className=a(164),document[a(281)]("button")))[a(172)]="mode-switch-btn active",o[a(376)]="聊天",o[a(196)]=()=>this[a(186)](a(225)),document.createElement("button"))).className="mode-switch-btn",e[a(376)]="搜索",e[a(196)]=()=>this[a(186)]("search"),i[a(252)](o),i[a(252)](e),document[a(281)](a(233)));(e=(o[a(172)]="close-btn",o[a(376)]="关闭",o[a(196)]=()=>this[a(282)](document[a(262)](a(266)),document[a(262)](".postChatMagic-messages"),document.querySelector(".postChatMagic-overlay")),t[a(252)](n),t.appendChild(i),t[a(252)](o),s[a(252)](t),document[a(281)](a(227))))[a(172)]=a(152);let r=document[a(281)](a(197));r[a(172)]="postChatMagic-input",a(295)!==this[a(264)]||window[a(308)][a(277)][a(374)](a(329))?r[a(248)]=a(263):r.placeholder="你正在使用演示知识库，更换账户Key来使用自己的知识库",r.rows=1,(n=document[a(281)]("button")).className=a(156),n[a(163)]=a(364),e[a(252)](r),e[a(252)](n),s[a(252)](e),r[a(272)]("input",(()=>{var t=a;r[t(334)].height=t(382);var e=r[t(185)];""!==r[t(320)][t(175)]()&&40<e&&(e=Math.min(e,120),r[t(334)][t(335)]=e+"px")})),(i=document.createElement(a(227)))[a(172)]="postChatMagic-Info",window[a(285)]?.showInviteLink&&(i[a(334)][a(159)]=a(240),i[a(272)](a(205),(()=>{var t=a;window[t(183)](t(249)+this.key,t(312))})));let c=document[a(281)](a(356));c[a(172)]=a(193),c[a(272)](a(200),(()=>{var t=a;c[t(284)][t(245)]("loaded")})),c.src=window[a(285)]?.[a(293)]||a(280),c[a(209)]="PostChat Icon",(o=document[a(281)](a(227)))[a(172)]="info-title",(t=document[a(281)](a(227))).className=a(208),a(295)!==this[a(264)]||window[a(308)][a(277)][a(374)](a(329))?(o.textContent=window.postChatConfig?.[a(384)]||"PostChat",t.textContent=window[a(285)]?.[a(177)]||a(161)):(o[a(376)]=a(255),t[a(376)]="当前在试用PostChat，知识库使用的是张洪Heo网站的知识库，如需使用自己网站的数据，请购买并切换为自己的账户KEY。您可以访问 ai.tianli0.top 获取更多信息"),i[a(252)](c),i.appendChild(o),i[a(252)](t),s[a(252)](i),(n=document[a(281)](a(227)))[a(172)]=a(381),s[a(252)](n),window.postChatConfig?.[a(187)]?.[a(260)]&&this.renderdefaultChatQuestions(),(e=document[a(281)](a(227)))[a(172)]=a(341),e[a(376)]=(window.postChatConfig?.[a(384)]||"PostChat")+a(184),s[a(252)](e)}[zK(304)](){var t=zK;let e=document[t(303)](t(176)),a=document[t(262)](t(266)),s=document[t(262)](".postChatMagic-messages"),n=document[t(262)](t(315)),i=document[t(262)](t(173)),o=document[t(262)](".postChatMagic-input"),r=(n[t(272)](t(205),(()=>{this[t(282)](a,s,n)})),i.addEventListener(t(205),(async()=>{var e,a=t;this[a(157)]?(this.isStreaming=!1,i[a(163)]=a(364),i[a(284)][a(191)](a(362)),i[a(196)]=null):(e=o[a(320)][a(175)]())&&(this.handleSubmit(e),o[a(320)]="")})),o[t(272)]("keydown",(e=>{var a=t;a(359)!==e[a(264)]||e[a(316)]||e.isComposing||(e[a(373)](),i[a(205)]()),requestAnimationFrame((()=>{var t,e=a;o[e(334)][e(335)]=e(382),t=o.scrollHeight,""!==o[e(320)].trim()&&40<t&&(t=Math[e(328)](t,120),o[e(334)][e(335)]=t+"px")}))})),o.addEventListener("compositionend",(e=>{var a=t;e[a(228)][a(320)][a(175)]()})),s[t(272)](t(205),(e=>{e[t(228)]===s&&this.hideChat(a,s,n)})),document.querySelector(t(278)));r.addEventListener(t(205),(e=>{var i=t;e[i(228)]===r&&this[i(282)](a,s,n)})),document[t(272)](t(323),(i=>{var o=t;o(390)===i.key&&e[o(284)][o(347)]("active")&&this.hideChat(a,s,n)}))}[zK(221)](){var t=zK,e=document[t(262)](t(213));return e?e.getAttribute("data-postChat_key"):t(244)!=typeof tianliGPT_key?tianliGPT_key:(console[t(265)](t(190)),null)}[zK(224)](t,e=!1){var a=zK,s=document.querySelector(a(296)),n=document.querySelector(a(278)),i=document.querySelector(".clear-btn"),o=document[a(262)](a(337));n&&(n.style[a(354)]=a(292)),o&&(o.style[a(354)]="none");let r=document[a(281)](a(227)),c=(r[a(172)]=a(204)+(e?a(366):"ai-message"),document[a(281)](a(227)));if(c[a(172)]=a(351),e){c[a(376)]=t,r.appendChild(c),(n=document[a(281)](a(227))).className=a(371);let e=document.createElement(a(233));e[a(172)]=a(178),e[a(376)]="复制",e[a(272)](a(205),(()=>{var t=a,s=((s=document[t(281)]("div"))[t(163)]=c[t(163)],s[t(376)][t(243)](/\n$/,""));navigator[t(317)][t(235)](s)[t(214)]((()=>{var a=t;e[a(284)][a(245)](a(288)),e[a(376)]="成功",setTimeout((()=>{var t=a;e[t(284)][t(191)](t(288)),e[t(376)]="复制"}),2e3)})).catch((e=>{var a=t;console[a(265)](a(181),e)}))})),(o=document[a(281)](a(233)))[a(172)]=a(386),o[a(376)]="编辑",o[a(272)](a(205),(()=>this.editMessage(r,t))),n[a(252)](e),n[a(252)](o),r[a(252)](n)}else c.className=a(351),r.appendChild(c),(e=document[a(281)](a(227))).className=a(371),(o=document[a(281)](a(233)))[a(172)]=a(178),o[a(376)]="复制",e[a(252)](o),r[a(252)](e);s[a(252)](r),s[a(271)]=s[a(185)],i&&i.classList[a(245)](a(353))}[zK(301)](){var t=zK,e=document[t(262)](t(296)),a=document.createElement(t(227)),s=(a[t(172)]=t(313),document.createElement(t(227))),n=(s.className=t(351),s.textContent=t(236),document.createElement("div"));return n.className="message-tools",a[t(252)](s),a.appendChild(n),e[t(252)](a),e[t(271)]=e[t(185)],a}async[zK(306)](t,e=0){var a=zK;if(this.key){var s=document[a(262)](a(348)),n=(s&&(s[a(320)]="",s.dispatchEvent(new Event(a(314),{bubbles:!0,cancelable:!0}))),this[a(216)]&&((s=this[a(216)][a(262)](a(350)))[a(163)]=s[a(275)](a(246)),this[a(216)].classList[a(191)](a(358)),this.editingMessage=null),document[a(262)](".postChatMagic-submit"));let E;n[a(284)][a(245)](a(226));try{E=0===e?(this[a(224)](t,!0),this[a(301)]()):(E=document[a(262)](a(361)))||this.addLoadingMessage();var i=new Headers;let s;if(i[a(154)](a(206),a(270)),a(225)===this.mode){this[a(251)].push({role:a(211),content:t});var o=this[a(251)][a(349)](-6);if(!(s=await fetch(a(298)+this.key,{method:"POST",headers:i,body:JSON[a(237)]({messages:o,stream:!0,model:a(222),ChatID:a(166)+Date[a(219)]()}),redirect:"follow"})).ok)throw new Error(a(269)+s[a(254)]);E&&n.classList.remove(a(226)),this[a(157)]=!0,n.innerHTML=a(210),n.classList[a(245)](a(362));var r=document[a(281)](a(227));r[a(172)]="message ai-message";let C=document[a(281)](a(227));C[a(172)]=a(351);var c=document[a(281)](a(227));c[a(172)]=a(371);let f=document[a(281)]("button");f[a(172)]=a(178),f[a(376)]="复制",c.appendChild(f),r[a(252)](C),r[a(252)](c);var d=document[a(262)](a(296));d[a(252)](r);let y="";var l=s[a(217)][a(309)](),h=new TextDecoder;try{for(;this[a(157)];){var u,{value:m,done:p}=await l[a(241)]();if(p||!this[a(157)]){if(this[a(157)]=!1,!y&&e<2)return n.innerHTML=a(364),n[a(284)][a(191)](a(362)),n[a(196)]=null,r[a(191)](),await new Promise((t=>setTimeout(t,1e3))),this[a(306)](t,e+1);!y&&2<=e&&(E.classList[a(191)]("loading"),E[a(262)](a(350))[a(376)]=a(391),r.remove()),n[a(163)]=a(364),n[a(284)][a(191)](a(362)),n[a(196)]=null;break}for(u of h[a(258)](m)[a(182)]("\n"))if(""!==u[a(175)]()&&a(338)!==u)try{var g=u[a(243)](/^data:/,""),v=JSON[a(223)](g);if(v[a(336)]&&v[a(336)][0][a(276)]&&v.choices[0][a(276)][a(231)]){if(!y&&E&&(E.remove(),r.style.display=a(273)),y+=v.choices[0][a(276)][a(231)],this[a(342)])try{var w=new(marked[a(325)]);w[a(286)]=(t,e,s)=>a(194)+t+'" target="_blank" rel="noopener noreferrer"'+(e?a(331)+e+'"':"")+">"+s+a(330),C[a(163)]=marked.parse(y,{breaks:!0,gfm:!0,renderer:w}),C[a(174)](a(239)).forEach((t=>{var e=a,s=t[e(262)](e(220));s&&(t[e(232)][e(202)](s,t),t[e(191)]())})),C[a(174)](a(332))[a(297)]((t=>{var e=a,s=t[e(302)];if(e(299)!==s.parentNode[e(172)]){var n=document[e(281)](e(227));n[e(172)]="code-block-wrapper";let a=document[e(281)]("button");a[e(172)]=e(253),a[e(376)]="复制",a[e(272)]("click",(s=>{var n=e;s[n(373)](),s.stopPropagation(),s=t.textContent,a.classList.add(n(291)),navigator[n(317)][n(235)](s)[n(214)]((()=>{var t=n;a[t(376)]="成功",a[t(284)][t(191)]("copying"),a[t(284)][t(245)](t(288)),setTimeout((()=>{var e=t;a[e(284)][e(191)](e(288)),a[e(376)]="复制"}),2e3)})).catch((t=>{var e=n;console.error(e(181),t),a.textContent="失败",a.classList[e(191)](e(291)),a[e(284)].add("copy-failed"),setTimeout((()=>{var t=e;a[t(284)][t(191)](t(389)),a[t(376)]="复制"}),2e3)}))})),s[e(232)][e(202)](n,s),n[e(252)](a),n[e(252)](s)}}))}catch(t){C[a(376)]=y}else C.textContent=y;d[a(271)]=d[a(185)]}}catch(t){console.error(a(242),t)}}}finally{this[a(157)]=!1,n[a(284)][a(191)](a(362)),y&&f[a(272)]("click",(()=>{var t=a,e=((e=document[t(281)](t(227)))[t(163)]=C.innerHTML,e.textContent[t(243)](/\n$/,""));navigator[t(317)][t(235)](e)[t(214)]((()=>{var e=t;f[e(284)].add(e(288)),f[e(376)]="成功",setTimeout((()=>{var t=e;f[t(284)][t(191)](t(288)),f[t(376)]="复制"}),2e3)}))[t(321)]((e=>{var a=t;console[a(265)](a(181),e)}))}))}this[a(251)][a(198)]({role:a(360),content:y})}else try{var C=await(s=await fetch("https://ai.tianli0.top/api/VecSearch?key="+this[a(264)],{method:a(370),headers:i,body:JSON[a(237)]({content:t})}))[a(305)]();if(E[a(191)](),C[a(268)]&&0<C[a(268)].length){var f=document[a(281)](a(227)),y=(f.className=a(218),document[a(281)](a(227))),b=(y[a(172)]=a(351),y[a(376)]='我为你找到了关于"'+t+a(238)+C[a(268)].length+a(203),f[a(252)](y),document[a(262)](a(296))),M=(b.appendChild(f),document[a(281)]("div"));M[a(172)]=a(343);let e=document[a(281)](a(227));e[a(172)]=a(283),C.data.forEach(((t,s)=>{var n,i=a,o=document[i(281)](i(227)),r=(o[i(172)]=i(387),document[i(281)](i(227)));(n=((n=(r.className=i(167),document[i(281)]("a")))[i(327)]=t[i(326)],n[i(228)]="_blank",n[i(376)]=t[i(229)],r.appendChild(n),document[i(281)]("div")))[i(172)]=i(201),n.textContent=t[i(310)],o[i(252)](r),o.appendChild(n),e.appendChild(o)})),M[a(252)](e),b[a(252)](M);var z=b[a(174)](a(257)),k=z[z[a(260)]-1];k&&k.scrollIntoView({behavior:a(212),block:a(344)})}else this[a(224)]("未找到相关结果",!1)}finally{n[a(284)].remove("stopping")}}catch(s){if(this.isStreaming=!1,!(2<=e))return await new Promise((t=>setTimeout(t,1e3))),this[a(306)](t,e+1);E&&(E[a(284)][a(191)](a(162)),E[a(262)](a(350))[a(376)]=a(188)+s[a(207)]),console[a(265)](a(192),s)}finally{(2<=e||!this[a(157)])&&(n[a(163)]=a(364),n[a(284)][a(191)](a(362)),n[a(284)][a(191)](a(226)))}}else this[a(224)]("错误：未配置API密钥",!1)}[zK(282)](t,e,a){var s=zK,n=document.getElementById("postChatMagic"),i=document.querySelector(s(388)),o=document[s(262)](s(189)),r=document[s(262)](".postChatMagic-Info");(n=(n[s(284)][s(191)]("active"),t[s(284)][s(191)](s(234)),e[s(284)].remove(s(234)),a[s(284)][s(191)](s(234)),i.classList[s(191)]("heo_show"),o[s(284)][s(191)](s(234)),r&&r[s(284)][s(191)](s(234)),document[s(262)](".postChatMagic-default-questions")))&&n.classList.remove("heo_show"),void 0!==window[s(290)]&&(window[s(290)]=!1)}renderdefaultChatQuestions(){var t=zK;let e=document[t(262)](t(278));if(0<document[t(262)](t(296))[t(365)][t(260)])e[t(334)][t(354)]=t(292);else{e[t(163)]="";let s=[];t(225)===this[t(165)]?s=window[t(285)]?.defaultChatQuestions||[]:"search"===this[t(165)]&&(s=window[t(285)]?.[t(352)]||[]);var a=window[t(377)]<768?3:5;s[t(260)]>a&&(s=[...s][t(153)]((()=>.5-Math[t(261)]())).slice(0,a)),s[t(297)]((a=>{var s=t,n=document[s(281)]("button");n[s(172)]=s(380),n[s(376)]=a,n.addEventListener("click",(()=>{var t=s;this.handleSubmit(a),e[t(334)][t(354)]=t(292)})),e.appendChild(n)}))}}async[zK(372)](){var t=zK;if(!this[t(342)])return new Promise(((e,a)=>{var s=t,n=document[s(281)](s(169));n[s(324)]=s(367),n[s(363)]=()=>{this[s(342)]=!0,e()},n[s(355)]=a,document[s(322)][s(252)](n)}))}show(){var t=zK;return document[t(303)](t(176))?(this.showElements(),Promise[t(215)]()):(this[t(180)](),new Promise((t=>{setTimeout((()=>{this[p(368)](),t()}),50)})))}[zK(368)](){var t=zK;let e=document.getElementById(t(176)),a=document[t(262)](t(266)),s=document[t(262)](t(296)),n=document[t(262)](".postChatMagic-overlay"),i=document[t(262)](t(348)),o=document[t(262)](t(388)),r=document[t(262)](t(189)),c=document[t(262)](t(337));requestAnimationFrame((()=>{var d=t;e[d(284)][d(245)](d(155)),a.classList.add(d(234)),s[d(284)][d(245)]("heo_show"),n[d(284)].add(d(234)),o[d(284)][d(245)](d(234)),r.classList.add("heo_show"),void 0!==window[d(290)]&&(window[d(290)]=!0),c&&0===s[d(365)].length&&c[d(284)][d(245)]("heo_show"),window.postChatConfig?.defaultInput&&0===s[d(365)][d(260)]&&(l=document[d(229)],i[d(320)]="在"+l+"中，",l=new Event(d(314),{bubbles:!0,cancelable:!0}),i[d(333)](l)),setTimeout((()=>{i[d(168)]()}),300);var l=document[d(262)](d(278));l&&0===s[d(365)].length&&l[d(284)][d(245)](d(234))})),this.markedLoaded||this[t(372)]()[t(321)]((t=>{console.error("Failed to load marked.js:",t)}))}[zK(186)](t){var e=zK;this[e(165)]=t;var a=document[e(262)](e(375)),s=document.querySelector(e(311)),n=document.querySelector(".postChatMagic-messages"),i=document[e(262)](e(278));e(225)===t?(a[e(284)].add("active"),s[e(284)][e(191)]("active")):(a.classList[e(191)](e(155)),s[e(284)][e(245)](e(155))),0===n[e(365)].length&&i&&(i.style[e(354)]="",this[e(340)]())}[zK(274)](){var t=zK;this[t(157)]&&(this.isStreaming=!1,(e=document[t(262)](".postChatMagic-submit"))[t(163)]=t(364),e[t(284)][t(191)](t(362)),e[t(196)]=null);var e=document[t(262)](t(296)),a=document[t(262)](t(256)),s=document.querySelector(t(337)),n=document[t(262)](t(278));e[t(163)]="",this.chatHistory=[],s&&(s[t(334)][t(354)]="",s.classList[t(245)]("heo_show")),a&&a[t(284)][t(191)](t(234)),(window[t(285)]?.[t(187)]?.[t(260)]||window[t(285)]?.[t(352)]?.[t(260)])&&n&&(n[t(334)].display="",n.classList[t(245)](t(234)),this[t(340)]())}[zK(259)](t,e){var a=zK;if(!this.isStreaming&&!this[a(216)]){(this[a(216)]=t)[a(284)][a(245)](a(358));let o=t[a(262)](a(350)),r=o[a(163)],c=(o.setAttribute("data-original-html",r),document[a(281)](a(197)));c[a(320)]=e;var s=((i=document[a(281)](a(227)))[a(172)]=a(267),document.createElement(a(233))),n=(s[a(172)]=a(379),s[a(376)]="发送",document[a(281)](a(233))),i=(n[a(172)]="edit-cancel-btn",n[a(376)]="取消",i.appendChild(s),i[a(252)](n),o[a(163)]="",o.appendChild(c),o[a(252)](i),()=>{var t=a;c[t(334)].height=t(339),c[t(334)][t(335)]=c[t(185)]+"px"});c[a(272)](a(314),i),setTimeout(i,0),c[a(168)](),s.addEventListener(a(205),(async()=>{var s=a,n=c[s(320)].trim();if(n&&n!==e){let a=t;for(;a;){var i=a.nextElementSibling;a[s(191)](),a=i}var d=this[s(251)][s(195)]((t=>"user"===t[s(171)]&&t[s(231)]===e));-1!==d&&(this[s(251)]=this[s(251)].slice(0,d)),await this[s(306)](n)}else o[s(163)]=r,t[s(284)][s(191)](s(358));this[s(216)]=null})),n[a(272)](a(205),(()=>{var e=a;o.innerHTML=r,t[e(284)][e(191)](e(358)),this[e(216)]=null}))}}[zK(319)](t,e="chat",a=!1){return(async()=>{var s,n=p;if(await this[n(353)](),e&&this[n(165)]!==e&&this[n(186)](e),a)(s=t?.[n(175)]())&&await this.handleSubmit(s);else{let e=document[n(262)](n(348));e&&await new Promise((a=>{requestAnimationFrame((()=>{var s=p;e[s(320)]=t,e[s(333)](new Event(s(314),{bubbles:!0,cancelable:!0})),setTimeout((()=>{e[s(168)]()}),300),e[s(199)](t[s(260)],t[s(260)]),a()}))}))}})()}}function p(t,e){var a=W();return(p=function(t,e){return a[t-=152]})(t,e)}let postChatMagic=new PostChatMagic;window[zK(176)]=postChatMagic;