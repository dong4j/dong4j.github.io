var zK = p;
(function (Q, v) {
  var zQ = p,
    k = Q();
  while (!![]) {
    try {
      var L =
        (parseInt(zQ(0xf7)) / 0x1) * (-parseInt(zQ(0x12c)) / 0x2) +
        (-parseInt(zQ(0xa0)) / 0x3) * (-parseInt(zQ(0xfa)) / 0x4) +
        (parseInt(zQ(0x117)) / 0x5) * (-parseInt(zQ(0x15a)) / 0x6) +
        -parseInt(zQ(0x159)) / 0x7 +
        -parseInt(zQ(0x17a)) / 0x8 +
        (parseInt(zQ(0xe6)) / 0x9) * (-parseInt(zQ(0x13e)) / 0xa) +
        (-parseInt(zQ(0x121)) / 0xb) * (-parseInt(zQ(0x17f)) / 0xc);
      if (L === v) break;
      else k["push"](k["shift"]());
    } catch (K) {
      k["push"](k["shift"]());
    }
  }
})(W, 0xda7ca);
var d = (function () {
    var Q = !![];
    return function (v, k) {
      var L = Q
        ? function () {
            var zv = p;
            if (k) {
              var K = k[zv(0x11f)](v, arguments);
              return (k = null), K;
            }
          }
        : function () {};
      return (Q = ![]), L;
    };
  })(),
  z = d(this, function () {
    var zk = p;
    return z["toString"]()
      [zk(0x9e)](zk(0x171))
      [zk(0xaa)]()
      ["constructor"](z)
      [zk(0x9e)](zk(0x171));
  });
z();
function W() {
  var dp = [
    ".user-message",
    "decode",
    "editMessage",
    "length",
    "random",
    "querySelector",
    "请输入你的问题...",
    "key",
    "error",
    ".postChatMagic-container",
    "edit-actions",
    "data",
    "HTTP\x20error!\x20status:\x20",
    "application/json",
    "scrollTop",
    "addEventListener",
    "flex",
    "clearMessages",
    "getAttribute",
    "delta",
    "hostname",
    ".postChatMagic-default-questions",
    "10uNughN",
    "https://ai.tianli0.top/static/img/PostChat.webp",
    "createElement",
    "hideChat",
    "search-results-container",
    "classList",
    "postChatConfig",
    "link",
    "apply",
    "copied",
    "143juuSdr",
    "postChat_containerVisible",
    "copying",
    "none",
    "userIcon",
    "postChatMagic-Tools",
    "70b649f150276f289d1025508f60c5f58a",
    ".postChatMagic-messages",
    "forEach",
    "https://ai.tianli0.top/api/KnowledgeChat?key=",
    "code-block-wrapper",
    "2BpazWg",
    "addLoadingMessage",
    "parentElement",
    "getElementById",
    "bindEvents",
    "json",
    "handleSubmit",
    "postChatMagic-overlay",
    "location",
    "getReader",
    "summary",
    ".mode-switch-btn:last-child",
    "_blank",
    "message\x20ai-message\x20loading",
    "input",
    ".postChatMagic-overlay",
    "shiftKey",
    "clipboard",
    "41190Adeqcf",
    "magicUserInput",
    "value",
    "catch",
    "head",
    "keydown",
    "src",
    "Renderer",
    "url",
    "href",
    "min",
    "zhheo.com",
    "</a>",
    "\x20title=\x22",
    "pre\x20code",
    "dispatchEvent",
    "style",
    "height",
    "choices",
    ".postChatMagic-Info",
    "data:[DONE]",
    "auto",
    "renderdefaultChatQuestions",
    "postChatMagic-Tips",
    "markedLoaded",
    "message\x20ai-message\x20search-results",
    "start",
    "8610315lPpXiQ",
    "1118484gfWWFg",
    "contains",
    ".postChatMagic-input",
    "slice",
    ".message-content",
    "message-content",
    "defaultSearchQuestions",
    "show",
    "display",
    "onerror",
    "img",
    "createOverlay",
    "editing",
    "Enter",
    "assistant",
    ".message.ai-message.loading",
    "stopping",
    "onload",
    "<img\x20src=\x22https://ai.tianli0.top/static/icon/arrow-up-bold.svg\x22\x20alt=\x22发送\x22>",
    "children",
    "user-message",
    "https://ai.tianli0.top/static/plugin/marked.min.js",
    "showElements",
    "(((.+)+)+)+$",
    "POST",
    "message-tools",
    "loadMarked",
    "preventDefault",
    "endsWith",
    ".mode-switch-btn:first-child",
    "textContent",
    "innerWidth",
    "11598408loFUtj",
    "edit-save-btn",
    "default-question-btn",
    "postChatMagic-default-questions",
    "24px",
    "3066612ueqQwt",
    "userTitle",
    "createContainer",
    "edit-btn",
    "search-result",
    ".postChatMagic-Tools",
    "copy-failed",
    "Escape",
    "抱歉，服务器响应超时，请稍后重试",
    "postChatMagic-container",
    "sort",
    "append",
    "active",
    "postChatMagic-submit",
    "isStreaming",
    "search",
    "cursor",
    "3VzYjJN",
    "如果有问题欢迎问我哦！",
    "loading",
    "innerHTML",
    "mode-switch-container",
    "mode",
    "chat_",
    "search-result-title",
    "focus",
    "script",
    "toString",
    "role",
    "className",
    ".postChatMagic-submit",
    "querySelectorAll",
    "trim",
    "postChatMagic",
    "userDesc",
    "copy-btn",
    "clear-btn",
    "init",
    "复制失败:",
    "split",
    "open",
    "可能会生成错误的信息，请注意核实。",
    "scrollHeight",
    "switchMode",
    "defaultChatQuestions",
    "发生错误：",
    ".postChatMagic-Tips",
    "没有获取到key，代码可能没有安装正确。",
    "remove",
    "Error:",
    "info-icon",
    "<a\x20href=\x22",
    "findIndex",
    "onclick",
    "textarea",
    "push",
    "setSelectionRange",
    "load",
    "search-result-summary",
    "insertBefore",
    "\x20条结果",
    "message\x20",
    "click",
    "Content-Type",
    "message",
    "info-desc",
    "alt",
    "<img\x20src=\x22https://ai.tianli0.top/static/icon/stop-2.svg\x22\x20alt=\x22停止\x22>",
    "user",
    "smooth",
    "script[data-postChat_key]",
    "then",
    "resolve",
    "editingMessage",
    "body",
    "message\x20ai-message",
    "now",
    "pre",
    "getKey",
    "gpt-3.5-turbo",
    "parse",
    "addMessage",
    "chat",
    "disabled",
    "div",
    "target",
    "title",
    "1557VgcCUN",
    "content",
    "parentNode",
    "button",
    "heo_show",
    "writeText",
    "加载中...",
    "stringify",
    "\x22的\x20",
    ".code-block-wrapper",
    "pointer",
    "read",
    "Error\x20parsing\x20line:",
    "replace",
    "undefined",
    "add",
    "data-original-html",
    "366029ZJdcqB",
    "placeholder",
    "https://ai.tianli0.top/?InviteID=",
    "6816196ASNpBi",
    "chatHistory",
    "appendChild",
    "code-copy-btn",
    "status",
    "试用PostChat",
    ".clear-btn",
  ];
  W = function () {
    return dp;
  };
  return W();
}
class PostChatMagic {
  constructor() {
    var zL = p;
    (this[zL(0x108)] = this[zL(0xdd)]()),
      (this[zL(0x156)] = !0x1),
      (this[zL(0xfb)] = []),
      (this[zL(0xa5)] = "chat"),
      (this["isStreaming"] = !0x1),
      (this["editingMessage"] = null);
  }
  [zK(0xb4)]() {
    var zx = zK;
    let Q = document["getElementById"](zx(0xb0));
    Q
      ? (Q["innerHTML"] = "")
      : (((Q = document[zx(0x119)](zx(0xe3)))["id"] = zx(0xb0)),
        document["body"]["appendChild"](Q)),
      this[zx(0x165)](),
      this[zx(0x181)](),
      this["bindEvents"]();
  }
  [zK(0x165)]() {
    var zq = zK,
      Q = document[zq(0x119)]("div");
    (Q[zq(0xac)] = zq(0x133)), document[zq(0x12f)](zq(0xb0))[zq(0xfc)](Q);
  }
  [zK(0x181)]() {
    var zT = zK,
      Q = document[zT(0x12f)](zT(0xb0)),
      v = document[zT(0x119)]("div"),
      v =
        ((v[zT(0xac)] = "postChatMagic-messages"),
        Q[zT(0xfc)](v),
        document[zT(0x119)](zT(0xe3))),
      k = ((v["className"] = zT(0x126)), document[zT(0x119)]("button")),
      L =
        ((k[zT(0xac)] = zT(0xb3)),
        (k[zT(0x178)] = "清空"),
        (k[zT(0xc4)] = () => this["clearMessages"]()),
        document[zT(0x119)](zT(0xe3))),
      K = ((L["className"] = zT(0xa4)), document[zT(0x119)]("button")),
      x =
        ((K[zT(0xac)] = "mode-switch-btn\x20active"),
        (K[zT(0x178)] = "聊天"),
        (K[zT(0xc4)] = () => this[zT(0xba)](zT(0xe1))),
        document["createElement"]("button")),
      K =
        ((x["className"] = "mode-switch-btn"),
        (x[zT(0x178)] = "搜索"),
        (x[zT(0xc4)] = () => this[zT(0xba)]("search")),
        L[zT(0xfc)](K),
        L[zT(0xfc)](x),
        document[zT(0x119)](zT(0xe9))),
      x =
        ((K[zT(0xac)] = "close-btn"),
        (K[zT(0x178)] = "关闭"),
        (K[zT(0xc4)] = () =>
          this[zT(0x11a)](
            document[zT(0x106)](zT(0x10a)),
            document[zT(0x106)](".postChatMagic-messages"),
            document["querySelector"](".postChatMagic-overlay")
          )),
        v[zT(0xfc)](k),
        v["appendChild"](L),
        v[zT(0xfc)](K),
        Q[zT(0xfc)](v),
        document[zT(0x119)](zT(0xe3)));
    x[zT(0xac)] = zT(0x98);
    let q = document[zT(0x119)](zT(0xc5));
    (q[zT(0xac)] = "postChatMagic-input"),
      zT(0x127) !== this[zT(0x108)] ||
      window[zT(0x134)][zT(0x115)][zT(0x176)](zT(0x149))
        ? (q[zT(0xf8)] = zT(0x107))
        : (q["placeholder"] =
            "你正在使用演示知识库，更换账户Key来使用自己的知识库"),
      (q["rows"] = 0x1),
      ((k = document[zT(0x119)]("button")),
      (k["className"] = zT(0x9c)),
      (k[zT(0xa3)] = zT(0x16c)),
      x[zT(0xfc)](q),
      x[zT(0xfc)](k),
      Q[zT(0xfc)](x),
      q[zT(0x110)]("input", () => {
        var zG = zT;
        q[zG(0x14e)]["height"] = zG(0x17e);
        var G = q[zG(0xb9)];
        "" !== q[zG(0x140)][zG(0xaf)]() &&
          0x28 < G &&
          ((G = Math["min"](G, 0x78)), (q[zG(0x14e)][zG(0x14f)] = G + "px"));
      }),
      (L = document["createElement"](zT(0xe3)))),
      ((L[zT(0xac)] = "postChatMagic-Info"),
      window[zT(0x11d)]?.["showInviteLink"] &&
        ((L[zT(0x14e)][zT(0x9f)] = zT(0xf0)),
        L[zT(0x110)](zT(0xcd), () => {
          var zB = zT;
          window[zB(0xb7)](zB(0xf9) + this["key"], zB(0x138));
        })));
    let T = document[zT(0x119)](zT(0x164));
    (T[zT(0xac)] = zT(0xc1)),
      T[zT(0x110)](zT(0xc8), () => {
        var zU = zT;
        T[zU(0x11c)][zU(0xf5)]("loaded");
      }),
      (T["src"] = window[zT(0x11d)]?.[zT(0x125)] || zT(0x118)),
      (T[zT(0xd1)] = "PostChat\x20Icon"),
      ((K = document[zT(0x119)](zT(0xe3))),
      (K[zT(0xac)] = "info-title"),
      (v = document[zT(0x119)](zT(0xe3))),
      (v["className"] = zT(0xd0)),
      zT(0x127) !== this[zT(0x108)] ||
      window[zT(0x134)][zT(0x115)][zT(0x176)](zT(0x149))
        ? ((K["textContent"] =
            window["postChatConfig"]?.[zT(0x180)] || "PostChat"),
          (v["textContent"] = window[zT(0x11d)]?.[zT(0xb1)] || zT(0xa1)))
        : ((K[zT(0x178)] = zT(0xff)),
          (v[zT(0x178)] =
            "当前在试用PostChat，知识库使用的是张洪Heo网站的知识库，如需使用自己网站的数据，请购买并切换为自己的账户KEY。您可以访问\x20ai.tianli0.top\x20获取更多信息")),
      L[zT(0xfc)](T),
      L["appendChild"](K),
      L[zT(0xfc)](v),
      Q[zT(0xfc)](L),
      (k = document[zT(0x119)](zT(0xe3))),
      (k[zT(0xac)] = zT(0x17d)),
      Q[zT(0xfc)](k),
      window["postChatConfig"]?.[zT(0xbb)]?.[zT(0x104)] &&
        this["renderdefaultChatQuestions"](),
      (x = document[zT(0x119)](zT(0xe3)))),
      ((x[zT(0xac)] = zT(0x155)),
      (x[zT(0x178)] =
        (window["postChatConfig"]?.[zT(0x180)] || "PostChat") + zT(0xb8)),
      Q[zT(0xfc)](x));
  }
  [zK(0x130)]() {
    var zi = zK;
    let Q = document[zi(0x12f)](zi(0xb0)),
      v = document[zi(0x106)](zi(0x10a)),
      k = document[zi(0x106)](".postChatMagic-messages"),
      L = document[zi(0x106)](zi(0x13b)),
      K = document[zi(0x106)](zi(0xad)),
      x = document[zi(0x106)](".postChatMagic-input"),
      q =
        (L[zi(0x110)](zi(0xcd), () => {
          var zt = zi;
          this[zt(0x11a)](v, k, L);
        }),
        K["addEventListener"](zi(0xcd), async () => {
          var za = zi,
            T;
          this[za(0x9d)]
            ? ((this["isStreaming"] = !0x1),
              (K[za(0xa3)] = za(0x16c)),
              K[za(0x11c)][za(0xbf)](za(0x16a)),
              (K[za(0xc4)] = null))
            : (T = x[za(0x140)][za(0xaf)]()) &&
              (this["handleSubmit"](T), (x[za(0x140)] = ""));
        }),
        x[zi(0x110)]("keydown", (T) => {
          var zj = zi;
          zj(0x167) !== T[zj(0x108)] ||
            T[zj(0x13c)] ||
            T["isComposing"] ||
            (T[zj(0x175)](), K[zj(0xcd)]()),
            requestAnimationFrame(() => {
              var ze = zj,
                G;
              (x[ze(0x14e)][ze(0x14f)] = ze(0x17e)),
                (G = x["scrollHeight"]),
                "" !== x[ze(0x140)]["trim"]() &&
                  0x28 < G &&
                  ((G = Math[ze(0x148)](G, 0x78)),
                  (x[ze(0x14e)][ze(0x14f)] = G + "px"));
            });
        }),
        x["addEventListener"]("compositionend", (T) => {
          var zS = zi;
          T[zS(0xe4)][zS(0x140)][zS(0xaf)]();
        }),
        k[zi(0x110)](zi(0xcd), (T) => {
          var zJ = zi;
          T[zJ(0xe4)] === k && this["hideChat"](v, k, L);
        }),
        document["querySelector"](zi(0x116)));
    q["addEventListener"](zi(0xcd), (T) => {
      var zX = zi;
      T[zX(0xe4)] === q && this[zX(0x11a)](v, k, L);
    }),
      document[zi(0x110)](zi(0x143), (T) => {
        var zw = zi;
        zw(0x186) === T["key"] &&
          Q[zw(0x11c)][zw(0x15b)]("active") &&
          this["hideChat"](v, k, L);
      });
  }
  [zK(0xdd)]() {
    var zD = zK,
      Q = document[zD(0x106)](zD(0xd5));
    return Q
      ? Q["getAttribute"]("data-postChat_key")
      : zD(0xf4) != typeof tianliGPT_key
      ? tianliGPT_key
      : (console[zD(0x109)](zD(0xbe)), null);
  }
  [zK(0xe0)](Q, v = !0x1) {
    var zn = zK,
      k = document["querySelector"](zn(0x128)),
      L = document["querySelector"](zn(0x116)),
      K = document["querySelector"](".clear-btn"),
      x = document[zn(0x106)](zn(0x151));
    L && (L["style"][zn(0x162)] = zn(0x124)),
      x && (x["style"][zn(0x162)] = "none");
    let q = document[zn(0x119)](zn(0xe3)),
      T =
        ((q[zn(0xac)] = zn(0xcc) + (v ? zn(0x16e) : "ai-message")),
        document[zn(0x119)](zn(0xe3)));
    if (((T[zn(0xac)] = zn(0x15f)), v)) {
      (T[zn(0x178)] = Q),
        q["appendChild"](T),
        (L = document[zn(0x119)](zn(0xe3))),
        (L["className"] = zn(0x173));
      let G = document["createElement"](zn(0xe9));
      (G[zn(0xac)] = zn(0xb2)),
        (G[zn(0x178)] = "复制"),
        G[zn(0x110)](zn(0xcd), () => {
          var zy = zn,
            B = document[zy(0x119)]("div"),
            B =
              ((B[zy(0xa3)] = T[zy(0xa3)]), B[zy(0x178)][zy(0xf3)](/\n$/, ""));
          navigator[zy(0x13d)]
            [zy(0xeb)](B)
            [zy(0xd6)](() => {
              var zH = zy;
              G[zH(0x11c)][zH(0xf5)](zH(0x120)),
                (G[zH(0x178)] = "成功"),
                setTimeout(() => {
                  var zZ = zH;
                  G[zZ(0x11c)][zZ(0xbf)](zZ(0x120)), (G[zZ(0x178)] = "复制");
                }, 0x7d0);
            })
            ["catch"]((U) => {
              var zr = zy;
              console[zr(0x109)](zr(0xb5), U);
            });
        }),
        (x = document[zn(0x119)](zn(0xe9))),
        ((x[zn(0xac)] = zn(0x182)),
        (x[zn(0x178)] = "编辑"),
        x[zn(0x110)](zn(0xcd), () => this["editMessage"](q, Q)),
        L[zn(0xfc)](G),
        L[zn(0xfc)](x),
        q[zn(0xfc)](L));
    } else
      (T["className"] = zn(0x15f)),
        q["appendChild"](T),
        ((v = document[zn(0x119)](zn(0xe3))),
        (x = ((v["className"] = zn(0x173)), document[zn(0x119)](zn(0xe9))))),
        ((x[zn(0xac)] = zn(0xb2)),
        (x[zn(0x178)] = "复制"),
        v[zn(0xfc)](x),
        q[zn(0xfc)](v));
    k[zn(0xfc)](q),
      (k[zn(0x10f)] = k[zn(0xb9)]),
      K && K["classList"][zn(0xf5)](zn(0x161));
  }
  [zK(0x12d)]() {
    var zN = zK,
      Q = document[zN(0x106)](zN(0x128)),
      v = document["createElement"](zN(0xe3)),
      k = ((v[zN(0xac)] = zN(0x139)), document["createElement"](zN(0xe3))),
      L =
        ((k["className"] = zN(0x15f)),
        (k["textContent"] = zN(0xec)),
        document["createElement"]("div"));
    return (
      (L["className"] = "message-tools"),
      v[zN(0xfc)](k),
      v["appendChild"](L),
      Q[zN(0xfc)](v),
      (Q[zN(0x10f)] = Q[zN(0xb9)]),
      v
    );
  }
  async [zK(0x132)](Q, k = 0x0) {
    var zE = zK;
    if (this["key"]) {
      var K = document[zE(0x106)](zE(0x15c)),
        x =
          (K &&
            ((K[zE(0x140)] = ""),
            K["dispatchEvent"](
              new Event(zE(0x13a), { bubbles: !0x0, cancelable: !0x0 })
            )),
          this[zE(0xd8)] &&
            (((K = this[zE(0xd8)][zE(0x106)](zE(0x15e)))[zE(0xa3)] = K[
              zE(0x113)
            ](zE(0xf6))),
            this[zE(0xd8)]["classList"][zE(0xbf)](zE(0x166)),
            (this["editingMessage"] = null)),
          document[zE(0x106)](".postChatMagic-submit"));
      x[zE(0x11c)][zE(0xf5)](zE(0xe2));
      let z1;
      try {
        z1 =
          0x0 === k
            ? (this[zE(0xe0)](Q, !0x0), this[zE(0x12d)]())
            : (z1 = document[zE(0x106)](zE(0x169))) ||
              this["addLoadingMessage"]();
        var q = new Headers();
        q[zE(0x9a)](zE(0xce), zE(0x10e));
        let z2;
        if (zE(0xe1) === this["mode"]) {
          this[zE(0xfb)]["push"]({ role: zE(0xd3), content: Q });
          var T = this[zE(0xfb)][zE(0x15d)](-0x6);
          if (
            !(z2 = await fetch(zE(0x12a) + this["key"], {
              method: "POST",
              headers: q,
              body: JSON[zE(0xed)]({
                messages: T,
                stream: !0x0,
                model: zE(0xde),
                ChatID: zE(0xa6) + Date[zE(0xdb)](),
              }),
              redirect: "follow",
            }))["ok"]
          )
            throw new Error(zE(0x10d) + z2[zE(0xfe)]);
          z1 && x["classList"]["remove"](zE(0xe2)),
            (this[zE(0x9d)] = !0x0),
            (x["innerHTML"] = zE(0xd2)),
            x["classList"][zE(0xf5)](zE(0x16a));
          var G = document[zE(0x119)](zE(0xe3));
          G[zE(0xac)] = "message\x20ai-message";
          let z3 = document[zE(0x119)](zE(0xe3));
          z3[zE(0xac)] = zE(0x15f);
          var B = document[zE(0x119)](zE(0xe3));
          B[zE(0xac)] = zE(0x173);
          let z4 = document[zE(0x119)]("button");
          (z4[zE(0xac)] = zE(0xb2)),
            (z4[zE(0x178)] = "复制"),
            B["appendChild"](z4),
            G[zE(0xfc)](z3),
            G[zE(0xfc)](B);
          var U = document[zE(0x106)](zE(0x128));
          U[zE(0xfc)](G);
          let z5 = "";
          var j = z2[zE(0xd9)][zE(0x135)](),
            J = new TextDecoder();
          try {
            for (; this[zE(0x9d)]; ) {
              var X,
                { value: D, done: H } = await j[zE(0xf1)]();
              if (H || !this[zE(0x9d)]) {
                if (((this[zE(0x9d)] = !0x1), !z5 && k < 0x2))
                  return (
                    (x["innerHTML"] = zE(0x16c)),
                    x[zE(0x11c)][zE(0xbf)](zE(0x16a)),
                    (x[zE(0xc4)] = null),
                    G[zE(0xbf)](),
                    await new Promise((z6) => setTimeout(z6, 0x3e8)),
                    this[zE(0x132)](Q, k + 0x1)
                  );
                !z5 &&
                  0x2 <= k &&
                  (z1["classList"][zE(0xbf)]("loading"),
                  (z1[zE(0x106)](zE(0x15e))[zE(0x178)] = zE(0x187)),
                  G["remove"]()),
                  (x[zE(0xa3)] = zE(0x16c)),
                  x[zE(0x11c)][zE(0xbf)](zE(0x16a)),
                  (x[zE(0xc4)] = null);
                break;
              }
              for (X of J[zE(0x102)](D)[zE(0xb6)]("\x0a"))
                if ("" !== X[zE(0xaf)]() && zE(0x152) !== X)
                  try {
                    var Z = X[zE(0xf3)](/^data:/, ""),
                      N = JSON[zE(0xdf)](Z);
                    if (
                      N[zE(0x150)] &&
                      N[zE(0x150)][0x0][zE(0x114)] &&
                      N["choices"][0x0][zE(0x114)][zE(0xe7)]
                    ) {
                      !z5 &&
                        z1 &&
                        (z1["remove"](), (G["style"]["display"] = zE(0x111)));
                      var R = N["choices"][0x0][zE(0x114)][zE(0xe7)];
                      if (((z5 += R), this[zE(0x156)]))
                        try {
                          var I = new marked[zE(0x145)]();
                          (I[zE(0x11e)] = (z6, z7, z8) =>
                            zE(0xc2) +
                            z6 +
                            "\x22\x20target=\x22_blank\x22\x20rel=\x22noopener\x20noreferrer\x22" +
                            (z7 ? zE(0x14b) + z7 + "\x22" : "") +
                            ">" +
                            z8 +
                            zE(0x14a)),
                            (z3[zE(0xa3)] = marked["parse"](z5, {
                              breaks: !0x0,
                              gfm: !0x0,
                              renderer: I,
                            })),
                            z3[zE(0xae)](zE(0xef))["forEach"]((z6) => {
                              var zR = zE,
                                z7 = z6[zR(0x106)](zR(0xdc));
                              z7 &&
                                (z6[zR(0xe8)][zR(0xca)](z7, z6),
                                z6[zR(0xbf)]());
                            }),
                            z3[zE(0xae)](zE(0x14c))[zE(0x129)]((z6) => {
                              var zI = zE,
                                z7 = z6[zI(0x12e)];
                              if (zI(0x12b) !== z7["parentNode"][zI(0xac)]) {
                                var z8 = document[zI(0x119)](zI(0xe3));
                                z8[zI(0xac)] = "code-block-wrapper";
                                let z9 = document[zI(0x119)]("button");
                                (z9[zI(0xac)] = zI(0xfd)),
                                  (z9[zI(0x178)] = "复制"),
                                  z9[zI(0x110)]("click", (zz) => {
                                    var zs = zI;
                                    zz[zs(0x175)](),
                                      zz["stopPropagation"](),
                                      (zz = z6["textContent"]),
                                      (z9["classList"]["add"](zs(0x123)),
                                      navigator[zs(0x13d)]
                                        [zs(0xeb)](zz)
                                        [zs(0xd6)](() => {
                                          var zc = zs;
                                          (z9[zc(0x178)] = "成功"),
                                            z9[zc(0x11c)][zc(0xbf)]("copying"),
                                            z9[zc(0x11c)][zc(0xf5)](zc(0x120)),
                                            setTimeout(() => {
                                              var zu = zc;
                                              z9[zu(0x11c)][zu(0xbf)](
                                                zu(0x120)
                                              ),
                                                (z9[zu(0x178)] = "复制");
                                            }, 0x7d0);
                                        })
                                        ["catch"]((zd) => {
                                          var zV = zs;
                                          console["error"](zV(0xb5), zd),
                                            (z9["textContent"] = "失败"),
                                            z9["classList"][zV(0xbf)](
                                              zV(0x123)
                                            ),
                                            z9[zV(0x11c)]["add"]("copy-failed"),
                                            setTimeout(() => {
                                              var zh = zV;
                                              z9[zh(0x11c)][zh(0xbf)](
                                                zh(0x185)
                                              ),
                                                (z9[zh(0x178)] = "复制");
                                            }, 0x7d0);
                                        }));
                                  }),
                                  z7[zI(0xe8)][zI(0xca)](z8, z7),
                                  z8[zI(0xfc)](z9),
                                  z8[zI(0xfc)](z7);
                              }
                            });
                        } catch (z6) {
                          z3[zE(0x178)] = z5;
                        }
                      else z3["textContent"] = z5;
                      U[zE(0x10f)] = U[zE(0xb9)];
                    }
                  } catch (z7) {
                    console["error"](zE(0xf2), z7);
                  }
            }
          } finally {
            (this[zE(0x9d)] = !0x1),
              x[zE(0x11c)][zE(0xbf)](zE(0x16a)),
              z5 &&
                z4[zE(0x110)]("click", () => {
                  var zF = zE,
                    z8 = document[zF(0x119)](zF(0xe3)),
                    z8 =
                      ((z8[zF(0xa3)] = z3["innerHTML"]),
                      z8["textContent"][zF(0xf3)](/\n$/, ""));
                  navigator[zF(0x13d)]
                    [zF(0xeb)](z8)
                    [zF(0xd6)](() => {
                      var zA = zF;
                      z4[zA(0x11c)]["add"](zA(0x120)),
                        (z4[zA(0x178)] = "成功"),
                        setTimeout(() => {
                          var zC = zA;
                          z4[zC(0x11c)][zC(0xbf)](zC(0x120)),
                            (z4[zC(0x178)] = "复制");
                        }, 0x7d0);
                    })
                    [zF(0x141)]((z9) => {
                      var zg = zF;
                      console[zg(0x109)](zg(0xb5), z9);
                    });
                });
          }
          this[zE(0xfb)][zE(0xc6)]({ role: zE(0x168), content: z5 });
        } else
          try {
            var V = await (z2 = await fetch(
              "https://ai.tianli0.top/api/VecSearch?key=" + this[zE(0x108)],
              {
                method: zE(0x172),
                headers: q,
                body: JSON[zE(0xed)]({ content: Q }),
              }
            ))[zE(0x131)]();
            if (
              (z1[zE(0xbf)](), V[zE(0x10c)] && 0x0 < V[zE(0x10c)]["length"])
            ) {
              var F = document[zE(0x119)](zE(0xe3)),
                A =
                  ((F["className"] = zE(0xda)), document[zE(0x119)](zE(0xe3))),
                P =
                  ((A[zE(0xac)] = zE(0x15f)),
                  (A[zE(0x178)] =
                    "我为你找到了关于\x22" +
                    Q +
                    zE(0xee) +
                    V[zE(0x10c)]["length"] +
                    zE(0xcb)),
                  F[zE(0xfc)](A),
                  document[zE(0x106)](zE(0x128))),
                O = (P["appendChild"](F), document[zE(0x119)]("div"));
              O[zE(0xac)] = zE(0x157);
              let z8 = document[zE(0x119)](zE(0xe3));
              (z8[zE(0xac)] = zE(0x11b)),
                V["data"]["forEach"]((z9, zz) => {
                  var zo = zE,
                    zd = document[zo(0x119)](zo(0xe3)),
                    zW =
                      ((zd[zo(0xac)] = zo(0x183)),
                      document[zo(0x119)](zo(0xe3))),
                    zp =
                      ((zW["className"] = zo(0xa7)), document[zo(0x119)]("a")),
                    zp =
                      ((zp[zo(0x147)] = z9[zo(0x146)]),
                      (zp[zo(0xe4)] = "_blank"),
                      (zp[zo(0x178)] = z9[zo(0xe5)]),
                      zW["appendChild"](zp),
                      document[zo(0x119)]("div"));
                  (zp[zo(0xac)] = zo(0xc9)),
                    (zp["textContent"] = z9[zo(0x136)]),
                    zd[zo(0xfc)](zW),
                    zd["appendChild"](zp),
                    z8["appendChild"](zd);
                }),
                O[zE(0xfc)](z8),
                P[zE(0xfc)](O);
              var Y = P[zE(0xae)](zE(0x101)),
                z0 = Y[Y[zE(0x104)] - 0x1];
              z0 &&
                z0["scrollIntoView"]({ behavior: zE(0xd4), block: zE(0x158) });
            } else this[zE(0xe0)]("未找到相关结果", !0x1);
          } finally {
            x[zE(0x11c)]["remove"]("stopping");
          }
      } catch (z9) {
        if (((this["isStreaming"] = !0x1), !(0x2 <= k)))
          return (
            await new Promise((zz) => setTimeout(zz, 0x3e8)),
            this[zE(0x132)](Q, k + 0x1)
          );
        z1 &&
          (z1[zE(0x11c)][zE(0xbf)](zE(0xa2)),
          (z1[zE(0x106)](zE(0x15e))[zE(0x178)] = zE(0xbc) + z9[zE(0xcf)])),
          console[zE(0x109)](zE(0xc0), z9);
      } finally {
        (0x2 <= k || !this[zE(0x9d)]) &&
          ((x[zE(0xa3)] = zE(0x16c)),
          x[zE(0x11c)][zE(0xbf)](zE(0x16a)),
          x[zE(0x11c)][zE(0xbf)](zE(0xe2)));
      }
    } else this[zE(0xe0)]("错误：未配置API密钥", !0x1);
  }
  [zK(0x11a)](Q, v, k) {
    var zM = zK,
      L = document["getElementById"]("postChatMagic"),
      K = document["querySelector"](zM(0x184)),
      x = document[zM(0x106)](zM(0xbd)),
      q = document[zM(0x106)](".postChatMagic-Info"),
      L =
        (L[zM(0x11c)][zM(0xbf)]("active"),
        Q[zM(0x11c)][zM(0xbf)](zM(0xea)),
        v[zM(0x11c)]["remove"](zM(0xea)),
        k[zM(0x11c)][zM(0xbf)](zM(0xea)),
        K["classList"][zM(0xbf)]("heo_show"),
        x[zM(0x11c)][zM(0xbf)](zM(0xea)),
        q && q[zM(0x11c)][zM(0xbf)](zM(0xea)),
        document[zM(0x106)](".postChatMagic-default-questions"));
    L && L["classList"]["remove"]("heo_show"),
      void 0x0 !== window[zM(0x122)] && (window[zM(0x122)] = !0x1);
  }
  ["renderdefaultChatQuestions"]() {
    var zl = zK;
    let Q = document[zl(0x106)](zl(0x116));
    if (0x0 < document[zl(0x106)](zl(0x128))[zl(0x16d)][zl(0x104)])
      Q[zl(0x14e)][zl(0x162)] = zl(0x124);
    else {
      Q[zl(0xa3)] = "";
      let L = [];
      zl(0xe1) === this[zl(0xa5)]
        ? (L = window[zl(0x11d)]?.["defaultChatQuestions"] || [])
        : "search" === this[zl(0xa5)] &&
          (L = window[zl(0x11d)]?.[zl(0x160)] || []);
      var v,
        k = window[zl(0x179)] < 0x300 ? 0x3 : 0x5;
      L[zl(0x104)] > k &&
        ((v = [...L][zl(0x99)](() => 0.5 - Math[zl(0x105)]())),
        (L = v["slice"](0x0, k))),
        L[zl(0x129)]((K) => {
          var zf = zl,
            x = document[zf(0x119)]("button");
          (x[zf(0xac)] = zf(0x17c)),
            (x[zf(0x178)] = K),
            x["addEventListener"]("click", () => {
              var zm = zf;
              this["handleSubmit"](K), (Q[zm(0x14e)][zm(0x162)] = zm(0x124));
            }),
            Q["appendChild"](x);
        });
    }
  }
  async [zK(0x174)]() {
    var zP = zK;
    if (!this[zP(0x156)])
      return new Promise((Q, v) => {
        var zO = zP,
          k = document[zO(0x119)](zO(0xa9));
        (k[zO(0x144)] = zO(0x16f)),
          (k[zO(0x16b)] = () => {
            var zb = zO;
            (this[zb(0x156)] = !0x0), Q();
          }),
          (k[zO(0x163)] = v),
          document[zO(0x142)][zO(0xfc)](k);
      });
  }
  ["show"]() {
    var zY = zK;
    return document[zY(0x12f)](zY(0xb0))
      ? (this["showElements"](), Promise[zY(0xd7)]())
      : (this[zY(0xb4)](),
        new Promise((Q) => {
          setTimeout(() => {
            var d0 = p;
            this[d0(0x170)](), Q();
          }, 0x32);
        }));
  }
  [zK(0x170)]() {
    var d1 = zK;
    let Q = document["getElementById"](d1(0xb0)),
      v = document[d1(0x106)](d1(0x10a)),
      k = document[d1(0x106)](d1(0x128)),
      L = document[d1(0x106)](".postChatMagic-overlay"),
      K = document[d1(0x106)](d1(0x15c)),
      x = document[d1(0x106)](d1(0x184)),
      q = document[d1(0x106)](d1(0xbd)),
      T = document[d1(0x106)](d1(0x151));
    requestAnimationFrame(() => {
      var d2 = d1;
      Q[d2(0x11c)][d2(0xf5)](d2(0x9b)),
        v["classList"]["add"](d2(0xea)),
        k[d2(0x11c)][d2(0xf5)]("heo_show"),
        L[d2(0x11c)]["add"](d2(0xea)),
        x[d2(0x11c)][d2(0xf5)](d2(0xea)),
        q["classList"]["add"]("heo_show"),
        void 0x0 !== window[d2(0x122)] && (window[d2(0x122)] = !0x0),
        T &&
          0x0 === k[d2(0x16d)]["length"] &&
          T[d2(0x11c)][d2(0xf5)]("heo_show"),
        window["postChatConfig"]?.["defaultInput"] &&
          0x0 === k[d2(0x16d)][d2(0x104)] &&
          ((G = document[d2(0xe5)]),
          (K[d2(0x140)] = "在" + G + "中，"),
          (G = new Event(d2(0x13a), { bubbles: !0x0, cancelable: !0x0 })),
          K[d2(0x14d)](G)),
        setTimeout(() => {
          var d3 = d2;
          K[d3(0xa8)]();
        }, 0x12c);
      var G = document[d2(0x106)](d2(0x116));
      G && 0x0 === k[d2(0x16d)]["length"] && G[d2(0x11c)][d2(0xf5)](d2(0xea));
    }),
      this["markedLoaded"] ||
        this[d1(0x174)]()[d1(0x141)]((G) => {
          console["error"]("Failed\x20to\x20load\x20marked.js:", G);
        });
  }
  [zK(0xba)](Q) {
    var d4 = zK;
    this[d4(0xa5)] = Q;
    var v = document[d4(0x106)](d4(0x177)),
      k = document["querySelector"](d4(0x137)),
      L = document["querySelector"](".postChatMagic-messages"),
      K = document[d4(0x106)](d4(0x116));
    d4(0xe1) === Q
      ? (v[d4(0x11c)]["add"]("active"), k[d4(0x11c)][d4(0xbf)]("active"))
      : (v["classList"][d4(0xbf)](d4(0x9b)), k[d4(0x11c)][d4(0xf5)](d4(0x9b))),
      0x0 === L[d4(0x16d)]["length"] &&
        K &&
        ((K["style"][d4(0x162)] = ""), this[d4(0x154)]());
  }
  [zK(0x112)]() {
    var d5 = zK;
    this[d5(0x9d)] &&
      ((this["isStreaming"] = !0x1),
      ((Q = document[d5(0x106)](".postChatMagic-submit"))[d5(0xa3)] =
        d5(0x16c)),
      Q[d5(0x11c)][d5(0xbf)](d5(0x16a)),
      (Q[d5(0xc4)] = null));
    var Q = document[d5(0x106)](d5(0x128)),
      v = document[d5(0x106)](d5(0x100)),
      k = document["querySelector"](d5(0x151)),
      L = document[d5(0x106)](d5(0x116));
    (Q[d5(0xa3)] = ""),
      (this["chatHistory"] = []),
      k &&
        ((k[d5(0x14e)][d5(0x162)] = ""), k["classList"][d5(0xf5)]("heo_show")),
      v && v[d5(0x11c)][d5(0xbf)](d5(0xea)),
      (window[d5(0x11d)]?.[d5(0xbb)]?.[d5(0x104)] ||
        window[d5(0x11d)]?.[d5(0x160)]?.[d5(0x104)]) &&
        L &&
        ((L[d5(0x14e)]["display"] = ""),
        L["classList"][d5(0xf5)](d5(0xea)),
        this[d5(0x154)]());
  }
  [zK(0x103)](Q, v) {
    var d6 = zK;
    if (!this["isStreaming"] && !this[d6(0xd8)]) {
      (this[d6(0xd8)] = Q)[d6(0x11c)][d6(0xf5)](d6(0x166));
      let x = Q[d6(0x106)](d6(0x15e)),
        q = x[d6(0xa3)],
        T =
          (x["setAttribute"]("data-original-html", q),
          document[d6(0x119)](d6(0xc5)));
      T[d6(0x140)] = v;
      var k = document[d6(0x119)](d6(0xe3)),
        L = ((k[d6(0xac)] = d6(0x10b)), document["createElement"](d6(0xe9))),
        K =
          ((L[d6(0xac)] = d6(0x17b)),
          (L[d6(0x178)] = "发送"),
          document[d6(0x119)](d6(0xe9))),
        k =
          ((K[d6(0xac)] = "edit-cancel-btn"),
          (K[d6(0x178)] = "取消"),
          k["appendChild"](L),
          k[d6(0xfc)](K),
          (x[d6(0xa3)] = ""),
          x["appendChild"](T),
          x[d6(0xfc)](k),
          () => {
            var d7 = d6;
            (T[d7(0x14e)]["height"] = d7(0x153)),
              (T[d7(0x14e)][d7(0x14f)] = T[d7(0xb9)] + "px");
          });
      T[d6(0x110)](d6(0x13a), k),
        setTimeout(k, 0x0),
        T[d6(0xa8)](),
        L["addEventListener"](d6(0xcd), async () => {
          var d8 = d6,
            G = T[d8(0x140)]["trim"]();
          if (G && G !== v) {
            let j = Q;
            for (; j; ) {
              var B = j["nextElementSibling"];
              j[d8(0xbf)](), (j = B);
            }
            var U = this[d8(0xfb)][d8(0xc3)](
              (S) => "user" === S[d8(0xab)] && S[d8(0xe7)] === v
            );
            -0x1 !== U && (this[d8(0xfb)] = this[d8(0xfb)]["slice"](0x0, U)),
              await this[d8(0x132)](G);
          } else (x[d8(0xa3)] = q), Q[d8(0x11c)][d8(0xbf)](d8(0x166));
          this[d8(0xd8)] = null;
        }),
        K[d6(0x110)](d6(0xcd), () => {
          var d9 = d6;
          (x["innerHTML"] = q),
            Q[d9(0x11c)][d9(0xbf)](d9(0x166)),
            (this[d9(0xd8)] = null);
        });
    }
  }
  [zK(0x13f)](Q, v = "chat", k = !0x1) {
    return (async () => {
      var dz = p,
        L;
      if (
        (await this[dz(0x161)](),
        v && this[dz(0xa5)] !== v && this[dz(0xba)](v),
        k)
      )
        (L = Q?.[dz(0xaf)]()) && (await this["handleSubmit"](L));
      else {
        let K = document[dz(0x106)](dz(0x15c));
        K &&
          (await new Promise((x) => {
            requestAnimationFrame(() => {
              var dd = p;
              (K[dd(0x140)] = Q),
                K[dd(0x14d)](
                  new Event(dd(0x13a), { bubbles: !0x0, cancelable: !0x0 })
                ),
                setTimeout(() => {
                  var dW = dd;
                  K[dW(0xa8)]();
                }, 0x12c),
                K[dd(0xc7)](Q[dd(0x104)], Q[dd(0x104)]),
                x();
            });
          }));
      }
    })();
  }
}
function p(z, d) {
  var Q = W();
  return (
    (p = function (v, k) {
      v = v - 0x98;
      var L = Q[v];
      return L;
    }),
    p(z, d)
  );
}
let postChatMagic = new PostChatMagic();
window[zK(0xb0)] = postChatMagic;
